View(Rarefaction_AtlanticSharpnose_Stomach)
#Switch axis
Rarefaction_AtlanticSharpnose_Stomach_Reverse <- data.frame(t(Rarefaction_AtlanticSharpnose_Stomach[-1]))
colnames(Rarefaction_AtlanticSharpnose_Stomach_Reverse) <- Rarefaction_AtlanticSharpnose_Stomach[, 1]
View(Rarefaction_AtlanticSharpnose_Stomach_Reverse)
sample_data(Rarefaction_AtlanticSharpnose_Stomach_Reverse)
summary(Rarefaction_AtlanticSharpnose_Stomach_Reverse)
attach(Rarefaction_AtlanticSharpnose_Stomach_Reverse)
names(Rarefaction_AtlanticSharpnose_Stomach_Reverse)
#Plot all samples together
#Need to highlight both lines and run them together with command return
sp1_AtlanticSharpnose <- specaccum(Rarefaction_AtlanticSharpnose_Fecal_Reverse, object="species", permutations = 100)
sp2_AtlanticSharpnose <- specaccum(Rarefaction_AtlanticSharpnose_Stomach_Reverse, object="species", permutations = 100)
#Need to highlight both lines and run them together with command return
plot(sp1_AtlanticSharpnose, ylab="Species", xlab="Number of samples",col="blue",ci.type="poly", ci.col="lightblue", ci.lty = 0,
xlim=c(1, 6), ylim=c(1, 12))
lines(sp2_AtlanticSharpnose,col="darkgreen", ci.type="poly", ci.col=(rgb(0,1,0, alpha=0.3)), ci.lty = 0)
############################All rarefaction curves finished###############################
#Combine all figures into grid
#Need to highlight both lines and run them together with command return
layout(matrix(c(1, 2, 3, 4), nrow = 2,
ncol = 2, byrow = TRUE))
plot(sp1_Bonnethead, ylab="Species", xlab="Number of samples",col="blue",ci.type="poly", ci.col="lightblue", ci.lty = 0,
xlim=c(1, 11), ylim=c(1, 15))
lines(sp2_Bonnethead,col="darkgreen", ci.type="poly", ci.col=(rgb(0,1,0, alpha=0.3)), ci.lty = 0)
plot(sp1_Blacktip, ylab="Species", xlab="Number of samples",col="blue",ci.type="poly", ci.col="lightblue", ci.lty = 0,
xlim=c(1, 5), ylim=c(1, 12))
lines(sp2_Blacktip,col="darkgreen", ci.type="poly", ci.col=(rgb(0,1,0, alpha=0.3)), ci.lty = 0)
plot(sp1_Blacknose, ylab="Species", xlab="Number of samples",col="blue",ci.type="poly", ci.col="lightblue", ci.lty = 0,
xlim=c(1, 5), ylim=c(1, 12))
lines(sp2_Blacknose,col="darkgreen", ci.type="poly", ci.col=(rgb(0,1,0, alpha=0.3)), ci.lty = 0)
plot(sp1_AtlanticSharpnose, ylab="Species", xlab="Number of samples",col="blue",ci.type="poly", ci.col="lightblue", ci.lty = 0,
xlim=c(1, 6), ylim=c(1, 12))
lines(sp2_AtlanticSharpnose,col="darkgreen", ci.type="poly", ci.col=(rgb(0,1,0, alpha=0.3)), ci.lty = 0)
#Statistics Comparing the richness and diversity for prey at genus level
#Compare reads between fecal and stomach
reads<-read.csv("Data/NC_Sharks_Reads_Paired.csv")
t.test(reads, conf.level = 0.95)
#leveneTest compare reads between fecal and stomach
SampleType_NumberReads<-read.csv("Data/SampleType_NumberReads.csv")
leveneTest(Number_of_reads ~ Sample_type, SampleType_NumberReads)
#If the variances of groups are equal, the p-value should be greater than 0.05
#Calculate richness using only paired, normalized up to genus
richness_genus <- estimate_richness(NC_Shark_prey_genus_merge_med.norm.paired.ps, measures=c("Observed", "Shannon", "Simpson"))
#Replace NC and St numbers with material type manually
#write.csv(richness_genus, "richness_genus.csv")
richness_genus<-read.csv("Data/richness_genus.csv")
#Check for normality and variance
#Shannon (all paired samples)
richness_genus %>% group_by(material) %>% shapiro_test(Shannon)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_genus %>% levene_test(Shannon ~ material)
#If the variances of groups are equal, the p-value should be greater than 0.05. If the p-value of the Levene’s test is significant, suggesting that there is a significant difference between the variances of the two groups. Therefore, we’ll use the Weltch t-test, which doesn’t assume the equality of the two variances
#Compare difference in species diversity between sample types (Shannon–Wiener)
t.test(Shannon ~ material, data = richness_genus, paired = TRUE)
#########
#Simpson (all paired samples)
richness_genus %>% group_by(material) %>% shapiro_test(Simpson)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_genus %>% levene_test(Simpson ~ material)
#If the variances of groups are equal, the p-value should be greater than 0.05. If the p-value of the Levene’s test is significant, suggesting that there is a significant difference between the variances of the two groups. Therefore, we’ll use the Weltch t-test, which doesn’t assume the equality of the two variances
#Compare difference in species diversity between sample types (Simpson)
t.test(Simpson ~ material, data = richness_genus, paired = TRUE)
#########
#Number of genus' species richness (all paired samples)
richness_genus %>% group_by(material) %>% shapiro_test(genus)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_genus %>% levene_test(genus ~ material)
#If the variances of groups are equal, the p-value should be greater than 0.05.
#Compare the difference in the detected richness (number of genus' identified between sample types)
t.test(genus ~ material, data = richness_genus, paired = TRUE)
#Statistics Comparing the richness and diversity for prey at species level
#Calculate richness using only paired, normalized up to species
richness_species <- estimate_richness(NC_Shark_prey_species_merge_med.norm.paired.ps, measures=c("Observed", "Shannon", "Simpson"))
#Replace NC and St numbers with material type manually
#write.csv(richness_species, "richness_species.csv")
richness_species<-read.csv("Data/richness_species.csv")
#Check for normality and variance
#Shannon (all paired samples)
richness_species %>% group_by(material) %>% shapiro_test(Shannon)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_species %>% levene_test(Shannon ~ material)
#If the variances of groups are equal, the p-value should be greater than 0.05. If the p-value of the Levene’s test is significant, suggesting that there is a significant difference between the variances of the two groups. Therefore, we’ll use the Weltch t-test, which doesn’t assume the equality of the two variances
#Compare difference in species diversity between sample types (Shannon–Wiener)
t.test(Shannon ~ material, data = richness_species, paired = TRUE)
#########
#Simpson (all paired samples)
richness_species %>% group_by(material) %>% shapiro_test(Simpson)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_species %>% levene_test(Simpson ~ material)
#If the variances of groups are equal, the p-value should be greater than 0.05. If the p-value of the Levene’s test is significant, suggesting that there is a significant difference between the variances of the two groups. Therefore, we’ll use the Weltch t-test, which doesn’t assume the equality of the two variances
#Compare difference in species diversity between sample types (Simpson)
t.test(Simpson ~ material, data = richness_species, paired = TRUE)
#########
#Number of species' species richness (all paired samples)
richness_species %>% group_by(material) %>% shapiro_test(species)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_species %>% levene_test(species ~ material)
#If the variances of groups are equal, the p-value should be greater than 0.05.
#Compare the difference in the detected richness (number of genus' identified between sample types)
t.test(species ~ material, data = richness_species, paired = TRUE)
#plot
ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose")
#plot
ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Clibanarius vittatus"="gold", "Hexapanopeus angustifrons"="palevioletred", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Pomatomus saltatrix"="slateblue1", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Clibanarius vittatus"="gold", "Hexapanopeus angustifrons"="palevioletred", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Pomatomus saltatrix"="slateblue1", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Clibanarius vittatus"="gold", "Hexapanopeus angustifrons"="palevioletred", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Pomatomus saltatrix"="slateblue1", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Clibanarius vittatus"="gold", "Hexapanopeus angustifrons"="palevioletred", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Pomatomus saltatrix"="slateblue1", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose")
#Convert to presence absence:
NC_Shark_prey_species_merge.ps_paired.1.PA <- phyloseq_standardize_otu_abundance(NC_Shark_prey_species_merge.ps_paired.1, method = "pa")
#Top 20
top20occ = names(sort(taxa_sums(NC_Shark_prey_species_merge.ps_paired.1.PA), decreasing = TRUE)[1:20])
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20 = prune_taxa(top20occ, NC_Shark_prey_species_merge.ps_paired.1.PA)
#Now only by shark species (Atlantic sharpnose) - this is FOO
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose<-subset_samples(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20,Species..scientific.name.=="Rhizoprionodon terraenovae")
#Put it into dataframes
otu_df<-cbind(data.frame(otu_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose)))
otu_df$otu<-rownames(otu_df)
otu_df_long<-otu_df%>%
pivot_longer(cols = -otu,names_to = "sample",values_to = "presence")
otu_df_long$sample <-gsub(pattern = ".",
"-",
x=otu_df_long$sample,
fixed = TRUE)
sample_df<-cbind(data.frame(sample_data(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose)))
library(tidyverse)
sample_df<-rownames_to_column(sample_df, var = "sample")
sample_material_key<-sample_df%>%
select(sample,material)
taxa_df<-cbind(data.frame(tax_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose)))
taxa_df<-rownames_to_column(taxa_df,var="otu")
otu_species_key<-taxa_df%>%
select(otu,family,genus,species)
otu_df_long<-otu_df_long%>%
left_join(sample_material_key)%>%
left_join(otu_species_key)
merge_material_otu_counts<-otu_df_long%>%
group_by(material,species)%>%
summarise(total_count=sum(presence))%>%
ungroup()
merge_material_counts<-merge_material_otu_counts%>%
group_by(material)%>%
mutate(total_material=sum(total_count))%>%
ungroup()%>%
mutate(rel_prct=(total_count/total_material)*100)
#plot
ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Clibanarius vittatus"="gold", "Hexapanopeus angustifrons"="palevioletred", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Pomatomus saltatrix"="slateblue1", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Clibanarius vittatus"="gold", "Hexapanopeus angustifrons"="palevioletred", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Pomatomus saltatrix"="slateblue1", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
#plot
ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Clibanarius vittatus"="gold", "Hexapanopeus angustifrons"="palevioletred", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Pomatomus saltatrix"="slateblue1", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Clibanarius vittatus"="gold", "Hexapanopeus angustifrons"="palevioletred", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Pomatomus saltatrix"="slateblue1", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose")
#plot
ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
#Convert to presence absence:
NC_Shark_prey_species_merge.ps_paired.1.PA <- phyloseq_standardize_otu_abundance(NC_Shark_prey_species_merge.ps_paired.1, method = "pa")
#Top 20
top20occ = names(sort(taxa_sums(NC_Shark_prey_species_merge.ps_paired.1.PA), decreasing = TRUE)[1:20])
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20 = prune_taxa(top20occ, NC_Shark_prey_species_merge.ps_paired.1.PA)
#Now only by shark species (Atlantic sharpnose) - this is FOO
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose<-subset_samples(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20,Species..scientific.name.=="Rhizoprionodon terraenovae")
#Put it into dataframes
otu_df<-cbind(data.frame(otu_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose)))
otu_df$otu<-rownames(otu_df)
otu_df_long<-otu_df%>%
pivot_longer(cols = -otu,names_to = "sample",values_to = "presence")
otu_df_long$sample <-gsub(pattern = ".",
"-",
x=otu_df_long$sample,
fixed = TRUE)
sample_df<-cbind(data.frame(sample_data(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose)))
library(tidyverse)
sample_df<-rownames_to_column(sample_df, var = "sample")
sample_material_key<-sample_df%>%
select(sample,material)
taxa_df<-cbind(data.frame(tax_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose)))
taxa_df<-rownames_to_column(taxa_df,var="otu")
otu_species_key<-taxa_df%>%
select(otu,family,genus,species)
otu_df_long<-otu_df_long%>%
left_join(sample_material_key)%>%
left_join(otu_species_key)
merge_material_otu_counts<-otu_df_long%>%
group_by(material,species)%>%
summarise(total_count=sum(presence))%>%
ungroup()
merge_material_counts<-merge_material_otu_counts%>%
group_by(material)%>%
mutate(total_material=sum(total_count))%>%
ungroup()%>%
mutate(rel_prct=(total_count/total_material)*100)
#plot
ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
#plot
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose_plot <- ggplot(merge_material_counts,fill="species") +
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species),stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Atlantic sharpnose") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose_plot
#Now only by shark species (Bonnethead) - this is FOO
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead<-subset_samples(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20,Species..scientific.name.=="Sphyrna tiburo")
#Put it into dataframes
otu_df<-cbind(data.frame(otu_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead)))
otu_df$otu<-rownames(otu_df)
View(otu_df)
otu_df_long<-otu_df%>%
pivot_longer(cols = -otu,names_to = "sample",values_to = "presence")
otu_df_long$sample <-gsub(pattern = ".",
"-",
x=otu_df_long$sample,
fixed = TRUE)
sample_df<-cbind(data.frame(sample_data(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead)))
library(tidyverse)
sample_df<-rownames_to_column(sample_df, var = "sample")
View(sample_df)
#Now only by shark species (Bonnethead) - this is FOO
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead<-subset_samples(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20,Species..scientific.name.=="Sphyrna tiburo")
#Put it into dataframes
otu_df<-cbind(data.frame(otu_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead)))
otu_df$otu<-rownames(otu_df)
otu_df_long<-otu_df%>%
pivot_longer(cols = -otu,names_to = "sample",values_to = "presence")
otu_df_long$sample <-gsub(pattern = ".",
"-",
x=otu_df_long$sample,
fixed = TRUE)
sample_df<-cbind(data.frame(sample_data(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead)))
sample_df<-rownames_to_column(sample_df, var = "sample")
View(sample_df)
sample_df<-cbind(data.frame(sample_data(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead)))
sample_df<-rownames_to_column(sample_df, var = "sample")
sample_material_key<-sample_df%>%
select(sample,material)
taxa_df<-cbind(data.frame(tax_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead)))
taxa_df<-rownames_to_column(taxa_df,var="otu")
otu_species_key<-taxa_df%>%
select(otu,family,genus,species)
otu_df_long<-otu_df_long%>%
left_join(sample_material_key)%>%
left_join(otu_species_key)
otu_df_long<-otu_df_long%>%
left_join(sample_material_key)%>%
left_join(otu_species_key)
merge_material_otu_counts<-otu_df_long%>%
group_by(material,species)%>%
summarise(total_count=sum(presence))%>%
ungroup()
merge_material_counts<-merge_material_otu_counts%>%
group_by(material)%>%
mutate(total_material=sum(total_count))%>%
ungroup()%>%
mutate(rel_prct=(total_count/total_material)*100)
#plot
ggplot(merge_material_counts,fill="species")+
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species), color="black",stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Bonnethead")
#plot
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead_plot <- ggplot(merge_material_counts,fill="species")+
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species), stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Bonnethead")theme_classic() +
#plot
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead_plot <- ggplot(merge_material_counts,fill="species")+
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species), stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Bonnethead") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead_plot
#Now only by shark species (Blacknose) - this is FOO
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose<-subset_samples(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20,Species..scientific.name.=="Carcharhinus acronotus")
#Now only by shark species (Blacknose) - this is FOO
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose<-subset_samples(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20,Species..scientific.name.=="Carcharhinus acronotus")
#Put it into dataframes
otu_df<-cbind(data.frame(otu_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose)))
otu_df$otu<-rownames(otu_df)
otu_df_long<-otu_df%>%
pivot_longer(cols = -otu,names_to = "sample",values_to = "presence")
otu_df_long$sample <-gsub(pattern = ".",
"-",
x=otu_df_long$sample,
fixed = TRUE)
sample_df<-cbind(data.frame(sample_data(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose)))
sample_df<-rownames_to_column(sample_df, var = "sample")
sample_material_key<-sample_df%>%
select(sample,material)
taxa_df<-cbind(data.frame(tax_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose)))
#Put it into dataframes
otu_df<-cbind(data.frame(otu_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose)))
otu_df$otu<-rownames(otu_df)
otu_df_long<-otu_df%>%
pivot_longer(cols = -otu,names_to = "sample",values_to = "presence")
otu_df_long$sample <-gsub(pattern = ".",
"-",
x=otu_df_long$sample,
fixed = TRUE)
sample_df<-cbind(data.frame(sample_data(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose)))
sample_df<-rownames_to_column(sample_df, var = "sample")
sample_material_key<-sample_df%>%
select(sample,material)
taxa_df<-cbind(data.frame(tax_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose)))
taxa_df<-rownames_to_column(taxa_df,var="otu")
otu_species_key<-taxa_df%>%
select(otu,family,genus,species)
otu_df_long<-otu_df_long%>%
left_join(sample_material_key)%>%
left_join(otu_species_key)
merge_material_otu_counts<-otu_df_long%>%
group_by(material,species)%>%
summarise(total_count=sum(presence))%>%
ungroup()
merge_material_counts<-merge_material_otu_counts%>%
group_by(material)%>%
mutate(total_material=sum(total_count))%>%
ungroup()%>%
mutate(rel_prct=(total_count/total_material)*100)
#plot
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose_plot <- ggplot(merge_material_counts,fill="species")+
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species), stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Blacknose") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose_plot
#Now only by shark species (Blacktip) - this is FOO
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacktip<-subset_samples(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20,Species..scientific.name.=="Carcharhinus limbatus")
#Now only by shark species (Blacktip) - this is FOO
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacktip<-subset_samples(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20,Species..scientific.name.=="Carcharhinus limbatus")
#Put it into dataframes
otu_df<-cbind(data.frame(otu_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacktip)))
otu_df$otu<-rownames(otu_df)
otu_df_long<-otu_df%>%
pivot_longer(cols = -otu,names_to = "sample",values_to = "presence")
otu_df_long$sample <-gsub(pattern = ".",
"-",
x=otu_df_long$sample,
fixed = TRUE)
sample_df<-cbind(data.frame(sample_data(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacktip)))
sample_df<-rownames_to_column(sample_df, var = "sample")
sample_material_key<-sample_df%>%
select(sample,material)
taxa_df<-cbind(data.frame(tax_table(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacktip)))
taxa_df<-rownames_to_column(taxa_df,var="otu")
otu_species_key<-taxa_df%>%
select(otu,family,genus,species)
otu_df_long<-otu_df_long%>%
left_join(sample_material_key)%>%
left_join(otu_species_key)
merge_material_otu_counts<-otu_df_long%>%
group_by(material,species)%>%
summarise(total_count=sum(presence))%>%
ungroup()
merge_material_counts<-merge_material_otu_counts%>%
group_by(material)%>%
mutate(total_material=sum(total_count))%>%
ungroup()%>%
mutate(rel_prct=(total_count/total_material)*100)
#plot
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacktip_plot <- ggplot(merge_material_counts,fill="species")+
geom_bar(aes(x=material, y=rel_prct, color=species, fill=species), stat="identity", position="stack")+
ylab("Relative Percent of Occurrence by material type") +
xlab("Blacktip") +
theme_classic() + theme(text = element_text(size =11)) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_discrete(limits = c("Achelous gibbesii", "Achelous spinimanus", "Arenaeus cribrarius", "Callinectes sapidus", "Callinectes similis", "Clibanarius vittatus", "Hexapanopeus angustifrons", "Ovalipes ocellatus", "Penaeus setiferus",
"Rimapenaeus constrictus", "Squilla empusa", "Cynoscion nothus", "Cynoscion regalis", "Lagodon rhomboides", "Leiostomus xanthurus", "Myrophis punctatus", "Pomatomus saltatrix", "Synodus foetens", "Trichiurus lepturus", "Xyrichtys novacula")) +
scale_fill_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1")) +
scale_color_manual(values = c("Achelous gibbesii"="darkorange", "Achelous spinimanus"="darkorange4", "Arenaeus cribrarius"="darksalmon", "Callinectes sapidus"="goldenrod3", "Callinectes similis"="tomato", "Cynoscion nothus"="aquamarine4", "Cynoscion regalis"="darkolivegreen", "Hexapanopeus angustifrons"="palevioletred", "Lagodon rhomboides"="lightseagreen", "Leiostomus xanthurus"="palegreen", "Myrophis punctatus"="royalblue", "Ovalipes ocellatus"="yellow", "Penaeus setiferus"="red", "Pomatomus saltatrix"="slateblue1", "Rimapenaeus constrictus"="violetred", "Squilla empusa"="hotpink1", "Symphurus plagiusa"="slategray2", "Synodus foetens"="navyblue", "Trichiurus lepturus"="yellowgreen", "Xyrichtys novacula"="darkolivegreen1"))
NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacktip_plot
#Plot all together
library(gridExtra)
grid.arrange(NC_Shark_prey_species_merge.ps_paired.1_top20species.Blacktip_plot, NC_Shark_prey_species_merge.ps_paired.1_top20species.Blacknose_plot, NC_Shark_prey_species_merge.ps_paired.1_top20species.Bonnethead_plot, NC_Shark_prey_species_merge.ps_paired.1_top20species.AtlanticSharpnose_plot, ncol=2)
grid.arrange(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacktip_plot, NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose_plot, NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead_plot, NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose_plot, ncol=2)
grid.arrange(NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacktip_plot, NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Blacknose_plot, NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.Bonnethead_plot, NC_Shark_prey_species_merge.ps_paired.1.PA.Top20.AtlanticSharpnose_plot, ncol=2)
# Statistics for NMDS plot (prey at genus level)
jsd_dist_matrix <- phyloseq::distance(pseq_paired, method ="jsd")
set.seed(200)
vegan::adonis2(jsd_dist_matrix ~ phyloseq::sample_data(pseq_paired)$material*pseq_paired@sam_data$Species..scientific.name.)
permanova <- vegan::adonis2(jsd_dist_matrix ~ phyloseq::sample_data(pseq_paired)$material*pseq_paired@sam_data$Species..scientific.name.)
permanova
View(permanova)
permanova
######Fecal######
Rarefaction_Bonnethead_Fecal <- read.csv("Data/ASV_Bonnethead_Fecal.csv")
View(Rarefaction_Bonnethead_Fecal)
#Switch axis
Rarefaction_Bonnethead_Fecal_Reverse <- data.frame(t(Rarefaction_Bonnethead_Fecal[-1]))
colnames(Rarefaction_Bonnethead_Fecal_Reverse) <- Rarefaction_Bonnethead_Fecal[, 1]
View(Rarefaction_Bonnethead_Fecal_Reverse)
sample_data(Rarefaction_Bonnethead_Fecal_Reverse)
summary(Rarefaction_Bonnethead_Fecal_Reverse)
attach(Rarefaction_Bonnethead_Fecal_Reverse)
names(Rarefaction_Bonnethead_Fecal_Reverse)
######Stomach######
Rarefaction_Bonnethead_Stomach <- read.csv("Data/ASV_Bonnethead_Stomach.csv")
#Switch axis
Rarefaction_Bonnethead_Stomach_Reverse <- data.frame(t(Rarefaction_Bonnethead_Stomach[-1]))
colnames(Rarefaction_Bonnethead_Stomach_Reverse) <- Rarefaction_Bonnethead_Stomach[, 1]
sample_data(Rarefaction_Bonnethead_Stomach_Reverse)
summary(Rarefaction_Bonnethead_Stomach_Reverse)
attach(Rarefaction_Bonnethead_Stomach_Reverse)
names(Rarefaction_Bonnethead_Stomach_Reverse)
#Plot all samples together
#Need to highlight both lines and run them together with command return
sp1_Bonnethead <- specaccum(Rarefaction_Bonnethead_Fecal_Reverse, object="species", permutations = 100)
sp1_Bonnethead <- specaccum(Rarefaction_Bonnethead_Fecal_Reverse, object="species", permutations = 100)
sp2_Bonnethead <- specaccum(Rarefaction_Bonnethead_Stomach_Reverse, object="species", permutations = 100)
#Plot all samples together
#Need to highlight both lines and run them together with command return
sp1_Bonnethead <- specaccum(Rarefaction_Bonnethead_Fecal_Reverse, object="prey taxa", permutations = 100)
sp1_Bonnethead <- specaccum(Rarefaction_Bonnethead_Fecal_Reverse, object="prey taxa", permutations = 100)
sp2_Bonnethead <- specaccum(Rarefaction_Bonnethead_Stomach_Reverse, object="prey taxa", permutations = 100)
plot(sp1_Bonnethead, ylab="Number of Prey Taxa", xlab="Number of samples",col="blue",ci.type="poly", ci.col="lightblue", ci.lty = 0,
xlim=c(1, 11), ylim=c(1, 15))
lines(sp2_Bonnethead,col="darkgreen", ci.type="poly", ci.col=(rgb(0,1,0, alpha=0.3)), ci.lty = 0)
sp1_Bonnethead <- specaccum(Rarefaction_Bonnethead_Fecal_Reverse, object="prey taxa", permutations = 100, ci=2)
sp2_Bonnethead <- specaccum(Rarefaction_Bonnethead_Stomach_Reverse, object="prey taxa", permutations = 100, ci=2)
plot(sp1_Bonnethead, ylab="Number of Prey Taxa", xlab="Number of samples",col="blue",ci.type="poly", ci.col="lightblue", ci.lty = 0,
xlim=c(1, 11), ylim=c(1, 15))
lines(sp2_Bonnethead,col="darkgreen", ci.type="poly", ci.col=(rgb(0,1,0, alpha=0.3)), ci.lty = 0)
######Fecal######
Rarefaction_Bonnethead_Fecal <- read.csv("Data/ASV_Bonnethead_Fecal.csv")
View(Rarefaction_Bonnethead_Fecal)
sp1_Bonnethead <- specaccum(Rarefaction_Bonnethead_Fecal_Reverse, object="prey taxa", permutations = 100)
sp2_Bonnethead <- specaccum(Rarefaction_Bonnethead_Stomach_Reverse, object="prey taxa", permutations = 100)
sp1_Bonnethead <- specaccum(Rarefaction_Bonnethead_Fecal_Reverse, object="prey taxa", permutations = 100)
sp2_Bonnethead <- specaccum(Rarefaction_Bonnethead_Stomach_Reverse, object="prey taxa", permutations = 100)
plot(sp1_Bonnethead, ylab="Number of Prey Taxa", xlab="Number of samples",col="blue",ci.type="poly", ci.col="lightblue", ci.lty = 0,
xlim=c(1, 11), ylim=c(1, 15))
lines(sp2_Bonnethead,col="darkgreen", ci.type="poly", ci.col=(rgb(0,1,0, alpha=0.3)), ci.lty = 0)
sp1_Bonnethead <- specaccum(Rarefaction_Bonnethead_Fecal_Reverse, object="prey taxa", permutations = 100, ci=2)
sp2_Bonnethead <- specaccum(Rarefaction_Bonnethead_Stomach_Reverse, object="prey taxa", permutations = 100, ci=2)
plot(sp1_Bonnethead, ylab="Number of Prey Taxa", xlab="Number of samples",col="blue",ci.type="poly", ci.col="lightblue", ci.lty = 0,
xlim=c(1, 11), ylim=c(1, 15))
lines(sp2_Bonnethead,col="darkgreen", ci.type="poly", ci.col=(rgb(0,1,0, alpha=0.3)), ci.lty = 0)
sp1_Bonnethead <- specaccum(Rarefaction_Bonnethead_Fecal_Reverse, object="prey taxa", permutations = 100, ci=2)
sp2_Bonnethead <- specaccum(Rarefaction_Bonnethead_Stomach_Reverse, object="prey taxa", permutations = 100, ci=2)
