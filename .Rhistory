#Import Phyloseq object----
NC_Shark_prey_species_merge_paired.ps<-readRDS(file="../paired_phyloseq_data.rds")
NC_Shark_prey_species_merge_paired.ps
#Compare reads between fecal and stomach
reads<-read.csv("Data/NC_Sharks_Reads_Paired.csv")
t.test(reads, conf.level = 0.95)
#leveneTest compare reads between fecal and stomach
SampleType_NumberReads<-read.csv("Data/SampleType_NumberReads.csv")
leveneTest(Number_of_reads ~ Sample_type, SampleType_NumberReads)
#Calculate richness using only paired, normalized up to genus
richness_genus <- estimate_richness(NC_Shark_prey_genus_merge_med.norm.paired.ps, measures=c("Observed", "Shannon", "Simpson"))
#Replace NC and St numbers with material type manually
#write.csv(richness_genus, "richness_genus.csv")
richness_genus<-read.csv("Data/richness_genus.csv")
#Import Phyloseq object----
NC_Shark_prey_species_merge_paired.ps<-readRDS(file="../paired_phyloseq_data.rds")
NC_Shark_prey_species_merge_paired.ps
# top20species <- names(sort(taxa_sums(NC_Shark_prey_species_merge_paired.ps), decreasing=TRUE))[0:20]
# ps.top20species <- transform_sample_counts(NC_Shark_prey_species_merge_paired.ps, function(OTU) OTU/sum(OTU))
# ps.top20species <- prune_taxa(top20species, ps.top20species)
#
#Normalize number of reads in each sample using median sequencing depth.
total = median(sample_sums(NC_Shark_prey_species_merge_paired.ps))
standf = function(x, t=total) round(t * (x / sum(x)))
NC_Sharks.ps.species.med.norm = transform_sample_counts(NC_Shark_prey_species_merge_paired.ps, standf)
NC_Sharks.ps.species.med.norm
NC_Shark_prey_species_merge_med.norm.paired.ps<-NC_Sharks.ps.species.med.norm
View(NC_Sharks.ps.species.med.norm)
NC_Shark_prey_species_merge_med.norm.paired.ps
#merge motus by prey species with no NAs
NC_Shark_prey_species_merge1.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "species", NArm = TRUE)
#merge motus by prey species with no NAs
NC_Shark_prey_species_merge1.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "species", NArm = TRUE)
plot_bar(NC_Shark_prey_species_merge1.ps, fill = "family") +
geom_bar(aes(color=family, fill=family), stat="identity", position="stack")
plot_bar(NC_Shark_prey_species_merge1.ps, fill = "family") +
geom_bar(aes(color=family, fill=family), stat="identity", position="stack")
NC_Shark_prey_species_merge1.ps
NC_Shark_prey_species_merge1.ps
NC_Shark_prey_species_merge1.ps.prop <- transform_sample_counts(NC_Shark_prey_species_merge1.ps, function(species) species/sum(species))
NC_Shark_prey_species_merge1.ps.prop <- transform_sample_counts(NC_Shark_prey_species_merge1.ps, function(species) species/sum(species))
#Normalize number of reads in each sample using median sequencing depth.
total = median(sample_sums(NC_Shark_prey_species_merge1.ps))
standf = function(x, t=total) round(t * (x / sum(x)))
NC_Sharks.ps.species1.med.norm = transform_sample_counts(NC_Shark_prey_species_merge1.ps, standf)
#subset the paired samples
NC_Sharks.ps.species1.med.norm.paired.ps<-subset_samples(NC_Sharks.ps.species1.med.norm,Paired=="Yes")
NC_Sharks.ps.species1.med.norm.paired.ps
matched_fs_and_sts<- sample_data(NC_Sharks.ps.species1.med.norm.paired.ps)[,c("sample_id","material")]
matched_fs_and_sts$id<- rownames(sample_data(NC_Sharks.ps.species1.med.norm.paired.ps))
matched_fs_and_sts<-data.frame(matched_fs_and_sts)
matched_data_wide<-matched_fs_and_sts%>%
pivot_wider(id_cols = sample_id,names_from = material, values_from = id)
View(matched_data_wide)
# Extract OTU table data for stomach and fecal samples
stomach_data <- otu_table(NC_Sharks.ps.species1.med.norm.paired.ps)[, matched_data_wide$stomach]
fecal_data <- otu_table(NC_Sharks.ps.species1.med.norm.paired.ps)[, matched_data_wide$fecal]
dim(stomach_data)
dim(fecal_data)
colnames(stomach_data)
colnames(fecal_data)
#calculate distances and put them in a symmetrical matrix
pairwise_sorensen_distances<-as.matrix(print(phyloseq::distance(NC_Sharks.ps.species1.med.norm.paired.ps, method="sor", binary=TRUE, type= "samples", upper=TRUE, diag=TRUE)))
View(pairwise_sorensen_distances)
top20species <- names(sort(taxa_sums(NC_Shark_prey_species_merge.ps), decreasing=TRUE))[0:20]
ps.top20species <- transform_sample_counts(NC_Shark_prey_species_merge.ps, function(OTU) OTU/sum(OTU))
ps.top20species <- prune_taxa(top20species, ps.top20species)
top20species <- names(sort(taxa_sums(NC_Shark_prey_species_merge.ps), decreasing=TRUE))[0:20]
top20species <- names(sort(taxa_sums(NC_Shark_prey_species_merge.ps), decreasing=TRUE))[0:20]
NC_Shark_prey_species_merge_med.norm.paired.ps<-NC_Sharks.ps.species.med.norm
NC_Shark_prey_species_merge_med.norm.paired.ps
#merge motus by prey species with no NAs
NC_Shark_prey_species_merge1.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "species", NArm = TRUE)
NC_Shark_prey_species_merge1.ps
NC_Shark_prey_species_merge1.ps.prop <- transform_sample_counts(NC_Shark_prey_species_merge1.ps, function(species) species/sum(species))
#Normalize number of reads in each sample using median sequencing depth.
total = median(sample_sums(NC_Shark_prey_species_merge1.ps))
standf = function(x, t=total) round(t * (x / sum(x)))
NC_Sharks.ps.species1.med.norm = transform_sample_counts(NC_Shark_prey_species_merge1.ps, standf)
#subset the paired samples
NC_Sharks.ps.species1.med.norm.paired.ps<-subset_samples(NC_Sharks.ps.species1.med.norm,Paired=="Yes")
NC_Sharks.ps.species1.med.norm.paired.ps
matched_fs_and_sts<- sample_data(NC_Sharks.ps.species1.med.norm.paired.ps)[,c("sample_id","material")]
matched_fs_and_sts$id<- rownames(sample_data(NC_Sharks.ps.species1.med.norm.paired.ps))
matched_fs_and_sts<-data.frame(matched_fs_and_sts)
matched_data_wide<-matched_fs_and_sts%>%
pivot_wider(id_cols = sample_id,names_from = material, values_from = id)
# Extract OTU table data for stomach and fecal samples
stomach_data <- otu_table(NC_Sharks.ps.species1.med.norm.paired.ps)[, matched_data_wide$stomach]
# Extract OTU table data for stomach and fecal samples
stomach_data <- otu_table(NC_Sharks.ps.species1.med.norm.paired.ps)[, matched_data_wide$stomach]
# Extract OTU table data for stomach and fecal samples
stomach_data <- otu_table(NC_Sharks.ps.species1.med.norm.paired.ps)[, matched_data_wide$stomach]
fecal_data <- otu_table(NC_Sharks.ps.species1.med.norm.paired.ps)[, matched_data_wide$fecal]
dim(stomach_data)
dim(fecal_data)
colnames(stomach_data)
colnames(fecal_data)
#calculate distances and put them in a symmetrical matrix
pairwise_sorensen_distances<-as.matrix(print(phyloseq::distance(NC_Sharks.ps.species1.med.norm.paired.ps, method="sor", binary=TRUE, type= "samples", upper=TRUE, diag=TRUE)))
View(pairwise_sorensen_distances)
class(pairwise_sorensen_distances)
#make an empty column for numerical values
matched_data_wide$sor_dist<-NA_real_
for (shark_i in 1:nrow(matched_data_wide)){
stomach_id<-matched_data_wide$stomach[shark_i]
fecal_id<-matched_data_wide$fecal[shark_i]
matched_data_wide$sor_dist[shark_i]<-pairwise_sorensen_distances[stomach_id,fecal_id]
}
# Plot dissimilarity as a scatter plot
dissimilarity_plot <- ggplot(data = matched_data_wide, aes(x = sample_id, y = sor_dist, fill = sor_dist)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "black") +  # Adjust color scale
labs(title = "Sørensen Pairwise Dissimilarity between Prey Species in Stomach and Fecal Samples",
x = "Shark_ID",
y = "Sorensen Distances") +
theme_minimal() +
theme(text = element_text(size = 10),  # Adjust text size
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"))  # Adjust title size and style
print(dissimilarity_plot)
#merge motus by prey genus
NC_Shark_prey_genus_merge.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "genus", NArm = FALSE)
#merge motus by prey genus
NC_Shark_prey_genus_merge.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "genus", NArm = FALSE)
plot_bar(NC_Shark_prey_genus_merge.ps, fill = "genus") +
geom_bar(aes(color=genus, fill=genus), stat="identity", position="stack")
plot_bar(NC_Shark_prey_genus_merge.ps, fill = "genus") +
geom_bar(aes(color=genus, fill=genus), stat="identity", position="stack")
NC_Shark_prey_species_merge_paired.ps
NC_Shark_prey_species_merge_paired.ps
NC_Shark_prey_genus_merge.ps
NC_Shark_prey_genus_merge.ps
NC_Shark_prey_genus_merge.ps
sample_variables(NC_Shark_prey_genus_merge.ps)
rank_names(NC_Shark_prey_genus_merge.ps)
#Normalize number of reads in each sample using median sequencing depth.
total = median(sample_sums(NC_Shark_prey_genus_merge.ps))
standf = function(x, t=total) round(t * (x / sum(x)))
NC_Sharks.ps.genus.med.norm = transform_sample_counts(NC_Shark_prey_genus_merge.ps, standf)
NC_Sharks.ps.genus.med.norm
#Get just the fecal and stomach paired samples
NC_Shark_prey_genus_merge_med.norm.paired.ps<-NC_Sharks.ps.genus.med.norm
NC_Shark_prey_genus_merge_med.norm.paired.ps
#re-do Sorensen distances for the genus phyloseq object
genus_matched_fs_and_sts<- sample_data(NC_Shark_prey_genus_merge_med.norm.paired.ps)[,c("sample_id","material")]
genus_matched_fs_and_sts$id<- rownames(sample_data(NC_Shark_prey_genus_merge_med.norm.paired.ps))
genus_matched_fs_and_sts<-data.frame(genus_matched_fs_and_sts)
genus_matched_data_wide<-genus_matched_fs_and_sts%>%
pivot_wider(id_cols = sample_id,names_from = material, values_from = id)
View(genus_matched_data_wide)
#Calculate the mean and standard deviation of the sor for genus
genus_sor <- c(genus_matched_data_wide$sor_dist)
mean(genus_sor)
sd(genus_sor)
# Extract OTU table data for stomach and fecal samples
genus_stomach_data <- otu_table(NC_Shark_prey_genus_merge_med.norm.paired.ps)[, genus_matched_data_wide$stomach]
genus_fecal_data <- otu_table(NC_Shark_prey_genus_merge_med.norm.paired.ps)[, genus_matched_data_wide$fecal]
dim(genus_stomach_data)
dim(genus_fecal_data)
colnames(genus_stomach_data)
colnames(genus_fecal_data)
#calculate distances and put them in a symmetrical matrix
genus_pairwise_sorensen_distances<-as.matrix(print(phyloseq::distance(NC_Shark_prey_genus_merge_med.norm.paired.ps, method="sor", binary=TRUE, type= "samples", upper=TRUE, diag=TRUE)))
View(genus_pairwise_sorensen_distances)
class(genus_pairwise_sorensen_distances)
#make an empty column for numerical values
genus_matched_data_wide$sor_dist<-NA_real_
for (shark_i in 1:nrow(genus_matched_data_wide)){
stomach_id<-genus_matched_data_wide$stomach[shark_i]
fecal_id<-genus_matched_data_wide$fecal[shark_i]
genus_matched_data_wide$sor_dist[shark_i]<-genus_pairwise_sorensen_distances[stomach_id,fecal_id]
}
# Plot dissimilarity as a scatter plot
genus_dissimilarity_plot <- ggplot(data = genus_matched_data_wide, aes(x = sample_id, y = sor_dist, fill = sor_dist)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "black") +  # Adjust color scale
labs(title = "Sørensen Pairwise Dissimilarity between Prey Genuses found in Stomach and Fecal Samples",
x = "Shark_ID",
y = "Sorensen Distances") +
theme_minimal() +
theme(text = element_text(size = 10),  # Adjust text size
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"))  # Adjust title size and style
print(genus_dissimilarity_plot)
#merge motus by prey family
NC_Shark_prey_family_merge.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "family", NArm = FALSE)
#merge motus by prey family
NC_Shark_prey_family_merge.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "family", NArm = FALSE)
plot_bar(NC_Shark_prey_family_merge.ps, fill = "family") +
geom_bar(aes(color=family, fill=family), stat="identity", position="stack")
plot_bar(NC_Shark_prey_family_merge.ps, fill = "family") +
geom_bar(aes(color=family, fill=family), stat="identity", position="stack")
NC_Shark_prey_species_merge_paired.ps
NC_Shark_prey_species_merge_paired.ps
NC_Shark_prey_genus_merge.ps
NC_Shark_prey_genus_merge.ps
NC_Shark_prey_family_merge.ps
NC_Shark_prey_family_merge.ps
sample_variables(NC_Shark_prey_family_merge.ps)
rank_names(NC_Shark_prey_family_merge.ps)
#Normalize number of reads in each sample using median sequencing depth.
total = median(sample_sums(NC_Shark_prey_family_merge.ps))
standf = function(x, t=total) round(t * (x / sum(x)))
NC_Sharks.ps.family.med.norm = transform_sample_counts(NC_Shark_prey_family_merge.ps, standf)
NC_Sharks.ps.family.med.norm
#Get just the fecal and stomach paired samples
NC_Shark_prey_family_merge_med.norm.paired.ps<-NC_Sharks.ps.family.med.norm
NC_Shark_prey_family_merge_med.norm.paired.ps
#re-do Sorensen distances for the family phyloseq object
family_matched_fs_and_sts<- sample_data(NC_Shark_prey_family_merge_med.norm.paired.ps)[,c("sample_id","material")]
family_matched_fs_and_sts$id<- rownames(sample_data(NC_Shark_prey_family_merge_med.norm.paired.ps))
family_matched_fs_and_sts<-data.frame(family_matched_fs_and_sts)
family_matched_data_wide<-family_matched_fs_and_sts%>%
pivot_wider(id_cols = sample_id,names_from = material, values_from = id)
#Calculate the mean and standard deviation of the sor for family
family_sor <- c(family_matched_data_wide$sor_dist)
mean(family_sor)
sd(family_sor)
# Extract OTU table data for stomach and fecal samples
family_stomach_data <- otu_table(NC_Shark_prey_family_merge_med.norm.paired.ps)[, family_matched_data_wide$stomach]
family_fecal_data <- otu_table(NC_Shark_prey_family_merge_med.norm.paired.ps)[, family_matched_data_wide$fecal]
dim(family_stomach_data)
dim(family_fecal_data)
colnames(family_stomach_data)
colnames(family_fecal_data)
#calculate distances and put them in a symmetrical matrix
family_pairwise_sorensen_distances<-as.matrix(print(phyloseq::distance(NC_Shark_prey_family_merge_med.norm.paired.ps, method="sor", binary=TRUE, type= "samples", upper=TRUE, diag=TRUE)))
View(family_pairwise_sorensen_distances)
class(family_pairwise_sorensen_distances)
#make an empty column for numerical values
family_matched_data_wide$sor_dist<-NA_real_
for (shark_i in 1:nrow(family_matched_data_wide)){
stomach_id<-family_matched_data_wide$stomach[shark_i]
fecal_id<-family_matched_data_wide$fecal[shark_i]
family_matched_data_wide$sor_dist[shark_i]<-family_pairwise_sorensen_distances[stomach_id,fecal_id]
}
# Plot dissimilarity as a scatter plot
family_dissimilarity_plot <- ggplot(data = family_matched_data_wide, aes(x = sample_id, y = sor_dist, fill = sor_dist)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "black") +  # Adjust color scale
labs(title = "Sørensen Pairwise Dissimilarity between Prey Families found in Stomach and Fecal Samples",
x = "Shark_ID",
y = "Sorensen Distances") +
theme_minimal() +
theme(text = element_text(size = 10),  # Adjust text size
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"))  # Adjust title size and style
#merge motus by prey order
NC_Shark_prey_order_merge.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "order", NArm = FALSE)
plot_bar(NC_Shark_prey_order_merge.ps, fill = "order") +
geom_bar(aes(color=order, fill=order), stat="identity", position="stack")
plot_bar(NC_Shark_prey_order_merge.ps, fill = "order") +
geom_bar(aes(color=order, fill=order), stat="identity", position="stack")
NC_Shark_prey_species_merge_paired.ps
NC_Shark_prey_species_merge_paired.ps
NC_Shark_prey_genus_merge.ps
NC_Shark_prey_family_merge.ps
NC_Shark_prey_order_merge.ps
NC_Shark_prey_order_merge.ps
sample_variables(NC_Shark_prey_order_merge.ps)
rank_names(NC_Shark_prey_order_merge.ps)
#Normalize number of reads in each sample using median sequencing depth.
total = median(sample_sums(NC_Shark_prey_order_merge.ps))
standf = function(x, t=total) round(t * (x / sum(x)))
NC_Sharks.ps.order.med.norm = transform_sample_counts(NC_Shark_prey_order_merge.ps, standf)
NC_Sharks.ps.order.med.norm
#Get just the fecal and stomach paired samples
NC_Shark_prey_order_merge_med.norm.paired.ps<-NC_Sharks.ps.order.med.norm
NC_Shark_prey_order_merge_med.norm.paired.ps
order_matched_fs_and_sts<- sample_data(NC_Shark_prey_order_merge_med.norm.paired.ps)[,c("sample_id","material")]
order_matched_fs_and_sts$id<- rownames(sample_data(NC_Shark_prey_order_merge_med.norm.paired.ps))
order_matched_fs_and_sts<-data.frame(order_matched_fs_and_sts)
order_matched_data_wide<-order_matched_fs_and_sts%>%
pivot_wider(id_cols = sample_id,names_from = material, values_from = id)
# Extract OTU table data for stomach and fecal samples
order_stomach_data <- otu_table(NC_Shark_prey_order_merge_med.norm.paired.ps)[, order_matched_data_wide$stomach]
order_fecal_data <- otu_table(NC_Shark_prey_order_merge_med.norm.paired.ps)[, order_matched_data_wide$fecal]
dim(order_stomach_data)
dim(order_fecal_data)
colnames(order_stomach_data)
colnames(order_fecal_data)
#calculate distances and put them in a symmetrical matrix
order_pairwise_sorensen_distances<-as.matrix(print(phyloseq::distance(NC_Shark_prey_order_merge_med.norm.paired.ps, method="sor", binary=TRUE, type= "samples", upper=TRUE, diag=TRUE)))
View(order_pairwise_sorensen_distances)
class(order_pairwise_sorensen_distances)
#make an empty column for numerical values
order_matched_data_wide$sor_dist<-NA_real_
for (shark_i in 1:nrow(order_matched_data_wide)){
stomach_id<-order_matched_data_wide$stomach[shark_i]
fecal_id<-order_matched_data_wide$fecal[shark_i]
order_matched_data_wide$sor_dist[shark_i]<-order_pairwise_sorensen_distances[stomach_id,fecal_id]
}
# Plot dissimilarity as a scatter plot
order_dissimilarity_plot <- ggplot(data = order_matched_data_wide, aes(x = sample_id, y = sor_dist, fill = sor_dist)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "black") +  # Adjust color scale
labs(title = "Sørensen Pairwise Dissimilarity between Prey Orders found in Stomach and Fecal Samples",
x = "Shark_ID",
y = "Sorensen Distances") +
theme_minimal() +
theme(text = element_text(size = 10),  # Adjust text size
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"))  # Adjust title size and style
print(order_dissimilarity_plot)
#merge motus by prey family
NC_Shark_prey_species_merge.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "species", NArm = FALSE)
#merge motus by prey family
NC_Shark_prey_species_merge.ps <- tax_glom(NC_Shark_prey_species_merge_paired.ps, taxrank = "species", NArm = FALSE)
plot_bar(NC_Shark_prey_species_merge.ps, fill = "species") +
geom_bar(aes(color=species, fill=species), stat="identity", position="stack")
plot_bar(NC_Shark_prey_species_merge.ps, fill = "species") +
geom_bar(aes(color=species, fill=species), stat="identity", position="stack")
NC_Shark_prey_species_merge_paired.ps
NC_Shark_prey_species_merge_paired.ps
NC_Shark_prey_genus_merge.ps
NC_Shark_prey_family_merge.ps
NC_Shark_prey_family_merge.ps
NC_Shark_prey_species_merge.ps
rank_names(NC_Shark_prey_species_merge.ps)
#Normalize number of reads in each sample using median sequencing depth.
total = median(sample_sums(NC_Shark_prey_species_merge.ps))
standf = function(x, t=total) round(t * (x / sum(x)))
NC_Sharks.ps.species.med.norm = transform_sample_counts(NC_Shark_prey_species_merge.ps, standf)
NC_Sharks.ps.species.med.norm
#Get just the fecal and stomach paired samples
NC_Shark_prey_species_merge_med.norm.paired.ps<-NC_Sharks.ps.species.med.norm
NC_Shark_prey_species_merge_med.norm.paired.ps
NC_Shark_prey_species_merge_med.norm.paired.ps
species_matched_fs_and_sts<- sample_data(NC_Shark_prey_species_merge_med.norm.paired.ps)[,c("sample_id","material")]
species_matched_fs_and_sts$id<- rownames(sample_data(NC_Shark_prey_species_merge_med.norm.paired.ps))
species_matched_fs_and_sts<-data.frame(species_matched_fs_and_sts)
species_matched_data_wide<-species_matched_fs_and_sts%>%
pivot_wider(id_cols = sample_id,names_from = material, values_from = id)
#Calculate the mean and standard deviation of the sor for species
species_sor <- c(species_matched_data_wide$sor_dist)
mean(species_sor)
sd(species_sor)
# Extract OTU table data for stomach and fecal samples
species_stomach_data <- otu_table(NC_Shark_prey_species_merge_med.norm.paired.ps)[, species_matched_data_wide$stomach]
species_fecal_data <- otu_table(NC_Shark_prey_species_merge_med.norm.paired.ps)[, species_matched_data_wide$fecal]
dim(species_stomach_data)
dim(species_fecal_data)
colnames(species_stomach_data)
colnames(species_fecal_data)
#calculate distances and put them in a symmetrical matrix
species_pairwise_sorensen_distances<-as.matrix(print(phyloseq::distance(NC_Shark_prey_species_merge_med.norm.paired.ps, method="sor", binary=TRUE, type= "samples", upper=TRUE, diag=TRUE)))
View(species_pairwise_sorensen_distances)
class(species_pairwise_sorensen_distances)
#make an empty column for numerical values
species_matched_data_wide$sor_dist<-NA_real_
for (shark_i in 1:nrow(species_matched_data_wide)){
stomach_id<-species_matched_data_wide$stomach[shark_i]
fecal_id<-species_matched_data_wide$fecal[shark_i]
species_matched_data_wide$sor_dist[shark_i]<-species_pairwise_sorensen_distances[stomach_id,fecal_id]
}
# Plot dissimilarity as a scatter plot
species_dissimilarity_plot <- ggplot(data = species_matched_data_wide, aes(x = sample_id, y = sor_dist, fill = sor_dist)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "black") +  # Adjust color scale
labs(title = "Sørensen Pairwise Dissimilarity between Prey Families found in Stomach and Fecal Samples",
x = "Shark_ID",
y = "Sorensen Distances") +
theme_minimal() +
theme(text = element_text(size = 10),  # Adjust text size
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"))  # Adjust title size and style
print(species_dissimilarity_plot)
#Order
ggplot(data = order_matched_data_wide, aes(x = 1, y = sor_dist)) +
geom_violin(trim=FALSE) +
geom_dotplot(binaxis = "y",
stackdir = "center",
dotsize = 0.75) +
theme(legend.position = "none") +
labs(x="Order", y="Sørensen Similarity Index") +
theme_classic()
#Family
ggplot(data = family_matched_data_wide, aes(x = 1, y = sor_dist)) +
geom_violin(trim=FALSE) +
geom_dotplot(binaxis = "y",
stackdir = "center",
dotsize = 0.75) +
theme(legend.position = "none") +
labs(x="Family", y="Sørensen Similarity Index") +
theme_classic() +
ylim(-0.5,1.5)
#Genus
ggplot(data = genus_matched_data_wide, aes(x = 1, y = sor_dist)) +
geom_violin(trim=FALSE) +
geom_dotplot(binaxis = "y",
stackdir = "center",
dotsize = 0.75) +
theme(legend.position = "none") +
labs(x="Genus", y="Sørensen Similarity Index") +
theme_classic() +
ylim(-0.5,1.5)
#Species
ggplot(data = species_matched_data_wide, aes(x = 1, y = sor_dist)) +
geom_violin(trim=FALSE) +
geom_dotplot(binaxis = "y",
stackdir = "center",
dotsize = 0.75) +
theme(legend.position = "none") +
labs(x="Species", y="Sørensen Similarity Index") +
theme_classic() +
ylim(-0.5,1.5)
#Plot family, genus, and species all together
sorensen_family_plot <- ggplot(data = family_matched_data_wide, aes(x = 1, y = sor_dist)) +
geom_violin(trim=FALSE) +
geom_dotplot(binaxis = "y",
stackdir = "center",
dotsize = 0.75,) +
theme(legend.position = "none") +
labs(x="Family", y="Sørensen Similarity Index") +
theme_classic() +
ylim(-0.5,1.5)
sorensen_genus_plot <- ggplot(data = genus_matched_data_wide, aes(x = 1, y = sor_dist)) +
geom_violin(trim=FALSE) +
geom_dotplot(binaxis = "y",
stackdir = "center",
dotsize = 0.75) +
theme(legend.position = "none") +
labs(x="Genus", y=" ") +
theme_classic() +
ylim(-0.5,1.5)
sorensen_species_plot <- ggplot(data = species_matched_data_wide, aes(x = 1, y = sor_dist)) +
geom_violin(trim=FALSE) +
geom_dotplot(binaxis = "y",
stackdir = "center",
dotsize = 0.75) +
theme(legend.position = "none") +
labs(x="Species", y=" ") +
theme_classic() +
ylim(-0.5,1.5)
#install.packages("gridExtra")
library(gridExtra)
grid.arrange(sorensen_family_plot, sorensen_genus_plot,sorensen_species_plot, ncol=3)
#Compare reads between fecal and stomach
reads<-read.csv("Data/NC_Sharks_Reads_Paired.csv")
t.test(reads, conf.level = 0.95)
#leveneTest compare reads between fecal and stomach
SampleType_NumberReads<-read.csv("Data/SampleType_NumberReads.csv")
leveneTest(Number_of_reads ~ Sample_type, SampleType_NumberReads)
#Calculate richness using only paired, normalized up to genus
richness_genus <- estimate_richness(NC_Shark_prey_genus_merge_med.norm.paired.ps, measures=c("Observed", "Shannon", "Simpson"))
#Replace NC and St numbers with material type manually
#write.csv(richness_genus, "richness_genus.csv")
richness_genus<-read.csv("Data/richness_genus.csv")
#Shannon (all paired samples)
richness_genus %>% group_by(material) %>% shapiro_test(Shannon)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_genus %>% levene_test(Shannon ~ material)
#Compare difference in species diversity between sample types (Shannon–Wiener)
t.test(Shannon ~ material, data = richness_genus, paired = TRUE)
#Simpson (all paired samples)
richness_genus %>% group_by(material) %>% shapiro_test(Simpson)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_genus %>% levene_test(Simpson ~ material)
#Compare difference in species diversity between sample types (Simpson)
t.test(Simpson ~ material, data = richness_genus, paired = TRUE)
#Number of genus' species richness (all paired samples)
richness_genus %>% group_by(material) %>% shapiro_test(genus)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_genus %>% levene_test(genus ~ material)
#Compare the difference in the detected richness (number of genus' identified between sample types)
t.test(genus ~ material, data = richness_genus, paired = TRUE)
##ANOVA comparing the differences between sample types and shark species
#Difference between material types manually
difference_genus<-read.csv("Data/difference_genus.csv")
View(difference_genus)
#Shannon Diversity
aov_Shannon.Diff <- aov(Shannon_Diff ~ SharkSpecies, data = difference_genus)
summary(aov_Shannon.Diff)
#Simpson Diversity
aov_Simpson.Diff <- aov(Simpson_Diff ~ SharkSpecies, data = difference_genus)
summary(aov_Simpson.Diff)
summary(aov_Shannon.Diff)
#Calculate richness using only paired, normalized up to species
richness_species <- estimate_richness(NC_Shark_prey_species_merge_med.norm.paired.ps, measures=c("Observed", "Shannon", "Simpson"))
#Replace NC and St numbers with material type manually
#write.csv(richness_species, "richness_species.csv")
richness_species<-read.csv("Data/richness_species.csv")
#Shannon (all paired samples)
richness_species %>% group_by(material) %>% shapiro_test(Shannon)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_species %>% levene_test(Shannon ~ material)
#Compare difference in species diversity between sample types (Shannon–Wiener)
t.test(Shannon ~ material, data = richness_species, paired = TRUE)
#Simpson (all paired samples)
richness_species %>% group_by(material) %>% shapiro_test(Simpson)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_species %>% levene_test(Simpson ~ material)
#Compare difference in species diversity between sample types (Simpson)
t.test(Simpson ~ material, data = richness_species, paired = TRUE)
#Number of species' species richness (all paired samples)
richness_species %>% group_by(material) %>% shapiro_test(species)
#p value of less than 0.05 is normal, so these results are considered normal, YAY!
richness_species %>% levene_test(species ~ material)
#Compare the difference in the detected richness (number of genus' identified between sample types)
t.test(species ~ material, data = richness_species, paired = TRUE)
##ANOVA comparing the differences between sample types and shark species
#Difference between material types manually
difference_species<-read.csv("Data/difference_species.csv")
View(difference_species)
#Shannon Diversity
aov_Shannon.Diff <- aov(Shannon_Diff ~ SharkSpecies, data = difference_species)
summary(aov_Shannon.Diff)
#Shannon Diversity
aov_Shannon.Diff <- aov(Shannon_Diff ~ SharkSpecies, data = difference_species)
summary(aov_Shannon.Diff)
TukeyHSD(aov_Shannon.Diff)
